<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ“æ–‡å­—æ¯å­¸ç¿’ç³»çµ± (å–®é ç‰ˆ)</title>
    <style>
        body {
            font-family: 'Arial', 'Noto Sans CJK TC', sans-serif;
            background-color: #f4f7f6;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }

        /* é€šç”¨å€å¡Šæ¨£å¼ - ç”¨æ–¼æ¨¡æ“¬ä¸åŒé é¢ */
        .page-section {
            display: none; /* é è¨­éš±è—æ‰€æœ‰å€å¡Š */
            width: 100%;
            max-width: 1200px;
            padding: 20px 0;
            flex-direction: column; /* ç¢ºä¿ä¸»å€å¡Šå…§å®¹æ˜¯å‚ç›´æ’åˆ—çš„ */
        }
        
        /* é é¢æ¨™é¡Œèˆ‡å°èˆª */
        .header-controls {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .nav-button {
            padding: 10px 15px;
            background-color: #457b9d;
            color: white;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .nav-button:hover {
            background-color: #386b86;
        }
        /* æ¨™é¡Œå±…ä¸­ */
        .header-controls h1 {
            flex-grow: 1; /* ä½”æ“šå‰©é¤˜ç©ºé–“ */
            text-align: center;
            margin: 0; /* ç§»é™¤é è¨­é‚Šè· */
            color: #1d3557;
        }
        /* è®“è¿”å›æŒ‰éˆ•å’Œè¨ˆæ™‚å™¨/ç©ºç™½ä½”ä½ç¬¦å°é½Š */
        .control-spacer {
            width: 150px; /* è¨­ç½®ä¸€å€‹å¯¬åº¦ï¼Œè®“æ¨™é¡Œå±…ä¸­ */
            text-align: right;
        }


        /* === é¦–é æ¨£å¼ (Index) === */
        #index-page {
            display: flex; /* é¦–é é è¨­é¡¯ç¤º */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 80vh; 
            text-align: center;
        }
        #index-page h1 {
            color: #1d3557;
            margin-bottom: 40px;
            font-size: 2.5em;
        }
        .mode-container {
            display: flex;
            gap: 50px;
        }
        .mode-button {
            padding: 20px 40px;
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .mode-button:hover {
            transform: translateY(-5px);
        }
        #btn-learn { background-color: #457b9d; }
        #btn-learn:hover { background-color: #386b86; }
        #btn-quiz-mode { background-color: #e63946; }
        #btn-quiz-mode:hover { background-color: #c9303d; }

        /* === å­¸ç¿’æ¨¡å¼å…§å®¹æ¨£å¼ (Learn) === */
        #learn-page p {
            width: 100%;
            text-align: center;
        }
        #learn-page h2 {
            width: 100%;
            text-align: left;
            margin-top: 30px;
            color: #e63946;
            border-bottom: 2px solid #a8dadc;
            padding-bottom: 5px;
        }
        .card-container {
            display: flex;
            flex-wrap: wrap; 
            justify-content: flex-start; /* è®“å¡ç‰‡é å·¦å°é½Š */
            gap: 20px; 
            width: 100%;
        }
        .flashcard {
            background-color: #ffffff;
            border: 2px solid #457b9d;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 120px; 
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: default;
        }
        .korean-letter {
            font-size: 4em; 
            font-weight: bold;
            color: #1d3557; 
            margin-bottom: 5px;
        }
        .romanization {
            font-size: 1em;
            color: #e63946; 
            font-style: italic;
        }
        
        /* === æ¸¬é©—æ¨¡å¼æ¨£å¼ (Quiz) === */
        #quiz-selection {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 40px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        #timer {
            font-size: 2em;
            font-weight: bold;
            color: #e63946;
            background-color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        #question-card {
            background-color: #ffffff;
            border: 3px solid #1d3557;
            border-radius: 15px;
            padding: 30px 20px;
            margin-bottom: 40px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        #korean-letter {
            font-size: 6em;
            font-weight: bold;
            color: #1d3557;
            margin: 0;
        }
        #options-container {
            display: flex;
            justify-content: space-around;
            gap: 20px;
        }
        .option-button {
            flex: 1;
            padding: 20px 10px;
            font-size: 1.5em;
            font-weight: bold;
            border: 2px solid #a8dadc;
            background-color: #f1faee;
            color: #1d3557;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        .option-button:hover {
            background-color: #e0f0ff;
            transform: scale(1.03);
        }
        #score-display {
            font-size: 1.5em;
            margin-top: 20px;
            font-weight: bold;
            color: #457b9d;
        }
        #result-modal {
            display: none;
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 30px;
            border: 1px solid #888;
            width: 80%;
            max-width: 400px;
            text-align: center;
            border-radius: 10px;
        }
        .modal-content h2 { color: #e63946; margin-top: 0; }
        .restart-button {
            padding: 10px 20px;
            background-color: #e63946;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <section id="index-page" class="page-section" style="display: flex;">
        <h1>ğŸ“š éŸ“æ–‡å­—æ¯å­¸ç¿’ç³»çµ±</h1>
        <div class="mode-container">
            <button id="btn-learn" class="mode-button" onclick="showPage('learn-page')">å­¸ç¿’æ¨¡å¼ (ç€è¦½)</button>
            <button id="btn-quiz-mode" class="mode-button" onclick="showPage('quiz-home-page')">æ¸¬é©—æ¨¡å¼ (ä¸‰é¸ä¸€)</button>
        </div>
    </section>

    <section id="learn-page" class="page-section">
        <div class="header-controls">
            <button class="nav-button" onclick="showPage('index-page')">â† è¿”å›é¦–é </button>
            <h1>ğŸ“š å­¸ç¿’æ¨¡å¼ï¼šéŸ“æ–‡å­—æ¯</h1>
            <div class="control-spacer"></div> </div>
        <p>ç€è¦½æ‰€æœ‰å­—æ¯åŠå…¶æ‹¼éŸ³ã€‚</p>
        
        <div class="card-container">
            </div>
    </section>

    <section id="quiz-home-page" class="page-section">
        <div class="header-controls">
            <button class="nav-button" onclick="showPage('index-page')">â† è¿”å›é¦–é </button>
            <h1>ğŸ§  æ¸¬é©—æ¨¡å¼</h1>
            <div class="control-spacer"></div>
        </div>
        <div id="quiz-selection">
            <h2>è«‹é¸æ“‡æ¸¬é©—æ¨¡å¼</h2>
            <button class="mode-button" style="background-color: #1d3557;" onclick="startQuiz('consonant')">å­éŸ³æ¨¡å¼ (19 å€‹å­—æ¯)</button>
            <button class="mode-button" style="background-color: #457b9d;" onclick="startQuiz('vowel')">æ¯éŸ³æ¨¡å¼ (21 å€‹å­—æ¯)</button>
            <button class="mode-button" style="background-color: #e63946;" onclick="startQuiz('mixed')">æ··åˆæ¨¡å¼ (40 å€‹å­—æ¯)</button>
        </div>
    </section>

    <section id="quiz-page" class="page-section">
        <div class="header-controls">
            <button class="nav-button" onclick="resetQuiz(); showPage('quiz-home-page');">â† è¿”å›é¸æ“‡</button>
            <h1 id="timer">01:30</h1> <div class="control-spacer"></div>
        </div>

        <div id="score-display">å¾—åˆ†: 0 / 0</div>

        <div id="question-card">
            <p id="korean-letter">è¼‰å…¥ä¸­...</p>
        </div>

        <div id="options-container">
            </div>
    </section>

    <div id="result-modal">
        <div class="modal-content">
            <h2>æ™‚é–“åˆ°ï¼æ¸¬é©—çµæŸ</h2>
            <p id="final-score"></p>
            <button class="restart-button" onclick="window.location.reload()">é‡æ–°é–‹å§‹</button>
        </div>
    </div>

<script>
    // ----------------------------------------------------
    // 1. é é¢åˆ‡æ›é‚è¼¯ (SPA æ ¸å¿ƒ)
    // ----------------------------------------------------
    function showPage(pageId) {
        // éš±è—æ‰€æœ‰é é¢
        document.querySelectorAll('.page-section').forEach(section => {
            section.style.display = 'none';
        });
        // é¡¯ç¤ºæŒ‡å®šçš„é é¢
        document.getElementById(pageId).style.display = 'flex'; 

        // ç¢ºä¿å­¸ç¿’æ¨¡å¼çš„å…§å®¹åœ¨é»æ“Šæ™‚æ‰ç”Ÿæˆ
        if (pageId === 'learn-page' && document.querySelector('#learn-page .card-container').children.length === 0) {
            generateLearnCards();
        }
    }

    // ----------------------------------------------------
    // 2. å­¸ç¿’æ¨¡å¼å¡ç‰‡ç”Ÿæˆ (æ•¸æ“šåº«ä¿æŒä¸è®Š)
    // ----------------------------------------------------
    const HANGUL_DATA_ALL = {
        consonants: [
            { h: 'ã„±', r: 'g / k' }, { h: 'ã„´', r: 'n' }, { h: 'ã„·', r: 'd / t' },
            { h: 'ã„¹', r: 'r / l' }, { h: 'ã…', r: 'm' }, { h: 'ã…‚', r: 'b / p' },
            { h: 'ã……', r: 's' }, { h: 'ã…‡', r: 'silent / ng' }, { h: 'ã…ˆ', r: 'j' },
            { h: 'ã…Š', r: 'ch' }, { h: 'ã…‹', r: 'k' }, { h: 'ã…Œ', r: 't' },
            { h: 'ã…', r: 'p' }, { h: 'ã…', r: 'h' }, { h: 'ã„²', r: 'kk' },
            { h: 'ã„¸', r: 'tt' }, { h: 'ã…ƒ', r: 'pp' }, { h: 'ã…†', r: 'ss' },
            { h: 'ã…‰', r: 'jj' }
        ],
        vowels: [
            { h: 'ã…', r: 'a' }, { h: 'ã…‘', r: 'ya' }, { h: 'ã…“', r: 'eo' },
            { h: 'ã…•', r: 'yeo' }, { h: 'ã…—', r: 'o' }, { h: 'ã…›', r: 'yo' },
            { h: 'ã…œ', r: 'u' }, { h: 'ã… ', r: 'yu' }, { h: 'ã…¡', r: 'eu' },
            { h: 'ã…£', r: 'i' }, { h: 'ã…', r: 'ae' }, { h: 'ã…’', r: 'yae' },
            { h: 'ã…”', r: 'e' }, { h: 'ã…–', r: 'ye' }, { h: 'ì™€', r: 'wa' },
            { h: 'ì™œ', r: 'wae' }, { h: 'ì™¸', r: 'oe' }, { h: 'ì›Œ', r: 'wo' },
            { h: 'ì›¨', r: 'we' }, { h: 'ìœ„', r: 'wi' }, { h: 'ì˜', r: 'ui / i' }
        ]
    };
    
    function generateLearnCards() {
        const container = document.querySelector('#learn-page .card-container');
        container.innerHTML = '';
        
        let htmlContent = '';

        // 1. å­éŸ³
        htmlContent += '<h2>1. åŸºç¤èˆ‡ç·ŠéŸ³å­éŸ³ (19)</h2>';
        HANGUL_DATA_ALL.consonants.forEach(item => {
            htmlContent += `<div class="flashcard"><div class="korean-letter">${item.h}</div><div class="romanization">${item.r}</div></div>`;
        });

        // 2. æ¯éŸ³
        htmlContent += '<h2>2. åŸºç¤èˆ‡è¤‡åˆæ¯éŸ³ (21)</h2>';
        HANGUL_DATA_ALL.vowels.forEach(item => {
            htmlContent += `<div class="flashcard"><div class="korean-letter">${item.h}</div><div class="romanization">${item.r}</div></div>`;
        });

        container.innerHTML = htmlContent;
    }

    // ----------------------------------------------------
    // 3. æ¸¬é©—æ¨¡å¼é‚è¼¯ (èˆ‡å…ˆå‰ç‰ˆæœ¬ç›¸åŒï¼Œç¢ºä¿åŠŸèƒ½ä¸è®Š)
    // ----------------------------------------------------

    let quizData = []; 
    let score = 0;
    let totalQuestions = 0;
    let timerInterval;
    const QUIZ_DURATION = 90; // 90 ç§’
    let timeRemaining = QUIZ_DURATION;

    function startQuiz(mode) {
        // 1. è¨­ç½®è³‡æ–™åº«
        if (mode === 'consonant') {
            quizData = HANGUL_DATA_ALL.consonants;
        } else if (mode === 'vowel') {
            quizData = HANGUL_DATA_ALL.vowels;
        } else { // mixed
            quizData = HANGUL_DATA_ALL.consonants.concat(HANGUL_DATA_ALL.vowels);
        }

        // 2. åˆå§‹åŒ–åˆ†æ•¸èˆ‡è¨ˆæ™‚å™¨
        score = 0;
        totalQuestions = 0;
        updateScoreDisplay();
        timeRemaining = QUIZ_DURATION;

        // 3. åˆ‡æ›é é¢ä¸¦é–‹å§‹éŠæˆ²æµç¨‹
        showPage('quiz-page');
        startTimer();
        loadNewQuestion();
    }
    
    function resetQuiz() {
        clearInterval(timerInterval);
        document.getElementById('timer').textContent = '01:30';
    }

    function getOptions(correctAnswer) {
        let allOptions = quizData.map(item => item.r); 
        
        let wrongOptionsPool = allOptions.filter(r => r !== correctAnswer.r);
        
        // éš¨æ©Ÿé¸æ“‡å…©å€‹ä¸é‡è¤‡çš„éŒ¯èª¤ç­”æ¡ˆ
        let wrongOptions = [];
        while (wrongOptions.length < 2 && wrongOptionsPool.length > 0) {
            const randomIndex = Math.floor(Math.random() * wrongOptionsPool.length);
            wrongOptions.push(wrongOptionsPool[randomIndex]);
            wrongOptionsPool.splice(randomIndex, 1);
        }

        let options = [correctAnswer.r].concat(wrongOptions);
        
        // æ´—ç‰Œ
        for (let i = options.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [options[i], options[j]] = [options[j], options[i]];
        }
        return options;
    }

    function loadNewQuestion() {
        if (quizData.length === 0) return; 

        // éš¨æ©Ÿé¸æ“‡ä¸€å€‹é¡Œç›®
        const randomIndex = Math.floor(Math.random() * quizData.length);
        const currentQuestion = quizData[randomIndex];

        document.getElementById('korean-letter').textContent = currentQuestion.h;

        // ç²å–é¸é …ä¸¦ç”ŸæˆæŒ‰éˆ•
        const options = getOptions(currentQuestion);
        const optionsContainer = document.getElementById('options-container');
        optionsContainer.innerHTML = '';

        options.forEach(option => {
            const button = document.createElement('button');
            button.className = 'option-button';
            button.textContent = option;
            button.onclick = () => checkAnswer(option, currentQuestion.r, button); 
            optionsContainer.appendChild(button);
        });
    }

    function checkAnswer(selectedOption, correctAnswer, button) {
        totalQuestions++;
        const isCorrect = selectedOption === correctAnswer;
        
        if (isCorrect) {
            score++;
            button.style.backgroundColor = '#d9f5d6'; 
        } else {
            button.style.backgroundColor = '#f5d6d6'; 
            document.querySelectorAll('.option-button').forEach(btn => {
                if (btn.textContent === correctAnswer) {
                    btn.style.border = '2px solid #28a745'; 
                }
            });
        }
        
        updateScoreDisplay();
        
        document.querySelectorAll('.option-button').forEach(btn => btn.disabled = true);
        
        setTimeout(() => {
            document.querySelectorAll('.option-button').forEach(btn => btn.disabled = false);
            loadNewQuestion(); 
        }, 500);
    }

    function updateScoreDisplay() {
        document.getElementById('score-display').textContent = `å¾—åˆ†: ${score} / ${totalQuestions}`;
    }

    // ----------------------------------------------------
    // 4. è¨ˆæ™‚å™¨é‚è¼¯
    // ----------------------------------------------------

    function startTimer() {
        clearInterval(timerInterval); 
        updateTimerDisplay();

        timerInterval = setInterval(() => {
            timeRemaining--;
            updateTimerDisplay();

            if (timeRemaining <= 0) {
                clearInterval(timerInterval);
                endQuiz();
            }
        }, 1000);
    }

    function updateTimerDisplay() {
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        document.getElementById('timer').textContent = 
            `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    }

    function endQuiz() {
        clearInterval(timerInterval);
        document.querySelectorAll('.option-button').forEach(btn => btn.disabled = true);

        document.getElementById('final-score').textContent = `æ‚¨çš„æœ€çµ‚å¾—åˆ†ç‚º: ${score} é¡Œ (å…±ä½œç­” ${totalQuestions} é¡Œ)`;
        document.getElementById('result-modal').style.display = 'block';
    }

    // ----------------------------------------------------
    // 5. åˆå§‹è¼‰å…¥
    // ----------------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
        // ç¢ºä¿åˆå§‹åªé¡¯ç¤ºé¦–é 
        showPage('index-page');
    });

</script>
</body>
</html>